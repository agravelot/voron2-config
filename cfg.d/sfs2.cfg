[filament_motion_sensor SFS_T0]
detection_length: 2.88 ; This can be adjusted to your desired level of sensitivity. 10 is a recomended value to prevent flow dropoff false triggers.
extruder: extruder
switch_pin: ^PG11
# switch_pin: !PG11              ; DIAG3, beside the probe sensor plug on Octopus 1.1
pause_on_runout: True ; This can be set to false to debug false positives putting the sensor in "monitor mode". The printer will not pause but it will run the runout_gcode below. 
event_delay: 3.0
pause_delay: 0.5
insert_gcode:
    M117 Filament sensor inserted!
runout_gcode:
    PAUSE
    M117 Runout sensor runout!


[filament_switch_sensor SFS_SWITCH_T0]
switch_pin: ^PG14 # as shown in Figure 2, switch sensor IO is PA0 pause_on_runout: False
insert_gcode:
    M117 Filament switch 
runout_gcode:
    PAUSE # [pause_resume] is required in printer.cfg
    M117 Filament switch runout

[delayed_gcode DISABLE_FILAMENT_SENSOR_BOOT] ; This will disable the SFS 1 second after klipper starts
initial_duration: 1
gcode:
    SFS_DISABLE

[gcode_macro SFS_ENABLE]
description: Enable smart filament sensors
gcode:
    M117 ENABLING the Smart Filament Sensors
    G92 E0
    SET_FILAMENT_SENSOR SENSOR=SFS_SWITCH_T0 ENABLE=1
    SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1 

[gcode_macro SFS_DISABLE]
description: Disable smart filament sensor s
gcode:
    M117 DISABLING the Smart Filament Sensors
    G92 E0
    SET_FILAMENT_SENSOR SENSOR=SFS_SWITCH_T0 ENABLE=0
    SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0 